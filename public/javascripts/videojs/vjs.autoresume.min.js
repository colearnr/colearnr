!function(){videojs.plugin("autoResume",function(t){var i=60,e=90,n=!1,o=!1,a=!1,s=!1,u=this.contentEl().getElementsByClassName("vjs-tech")[0].id,r=this,d=t.lbit_id,l=t.topic_id,c=t.start?parseInt(t.start,10):null,f=t.end?parseInt(t.end,10):null,h=void 0!==t.autoplay?t.autoplay:!0;h||(s=!0),this.autoResume.getLastPosition=function(t,e,n){e&&e>i?$.get("/video/position?lbit_id="+d+"&topic_id="+l).done(function(t){n(t&&t.lastPosition?t.lastPosition:null)}):n(null)},this.autoResume.controlPlay=function(t){if(!(!h||n||o&&a)&&t.duration()){var i=Math.round(t.currentTime());if(!(c&&i>=c&&f&&f>i))if(!o&&c&&c>i)o=!0,t.currentTime(c);else{if(!(!a&&f&&i>f))return;a=!0,t.currentTime(f),t.player().pause()}}},this.autoResume.resume=function(t){if(!n&&!s)if(c&&f&&f-c>i||!c){var o=Math.round(t.currentTime()),a=Math.round(t.duration()),u=0;t.autoResume.getLastPosition(o,a,function(i){i&&!n?(i=Math.round(i),a&&(u=Math.round(i/a*100),!isNaN(i)&&e>u?(t.currentTime(i),n=!0):s=!0)):a?s=!0:(s=!1,n=!1)})}else s=!0},this.on("play",function(){r.autoResume.resume(r)}),this.on("firstplay",function(){r.autoResume.resume(r)}),(c||f)&&this.on("timeupdate",function(){r.autoResume.controlPlay(r)}),!u||-1==u.indexOf("vimeo")&&-1==u.indexOf("ownvideo")&&-1==u.indexOf("hlslive")||this.on("timeupdate",function(){n||s||r.autoResume.resume(r)}),$.receiveMessage&&$.receiveMessage(function(t){if(t&&t.data&&"string"==typeof t.data&&t.data.indexOf("#t=")>-1){var i=t.data.split("#t=")[1],e=parseInt(i,10);i&&!isNaN(e)&&r.currentTime(e)}}),$(window).bind("hashchange",function(){if(window.location.hash&&-1!=window.location.hash.indexOf("t=")){var t=window.location.hash.indexOf("t="),i=window.location.hash.substring(t+2),e=parseInt(i,10);i&&!isNaN(e)&&r.currentTime(e)}})})}();