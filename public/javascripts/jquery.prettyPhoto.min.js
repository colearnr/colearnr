!function(e){function i(){var e=location.href;return hashtag=-1!==e.indexOf("#lbit")?decodeURI(e.substring(e.indexOf("#lbit")+1,e.length)):!1,hashtag}function t(){"undefined"!=typeof theRel&&(location.hash=lbit_id?"lbit="+lbit_id+(lbit_action?"/"+lbit_action:""):theRel+"/"+rel_index+"/")}function a(e,i){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var t="[\\?&]"+e+"=([^&#]*)",a=new RegExp(t),s=a.exec(i);return null==s?"":s[1]}e.prettyPhoto={version:"3.1.5"};var s=null;e.fn.prettyPhoto=function(o){function p(){e(".pp_loaderIcon").hide(),projectedTop=scroll_pos.scrollTop+(z/2-f.containerHeight/2),projectedTop<0&&(projectedTop=0),$ppt.fadeTo(settings.animation_speed,1),$pp_pic_holder.find(".pp_content").animate({height:f.contentHeight,width:f.contentWidth},settings.animation_speed),$pp_pic_holder.animate({top:projectedTop,left:I/2-f.containerWidth/2<0?0:I/2-f.containerWidth/2,width:f.containerWidth},settings.animation_speed,function(){var i=f.width,t=f.height;"image"==h(pp_images[set_position])&&"100%"==i?(t="auto",$pp_pic_holder.find("#pp_full_res").css("overflow","auto")):$pp_pic_holder.find("#pp_full_res").css("overflow","visible"),$pp_pic_holder.find(".pp_hoverContainer,#fullResImage").height(t).width(i),$pp_pic_holder.find(".pp_fade").fadeIn(settings.animation_speed),isSet&&"image"==h(pp_images[set_position])?$pp_pic_holder.find(".pp_hoverContainer").show():$pp_pic_holder.find(".pp_hoverContainer").hide(),settings.allow_expand&&(f.resized?e("a.pp_expand,a.pp_contract").show():e("a.pp_expand").hide()),!settings.autoplay_slideshow||x||w||e.prettyPhoto.startSlideshow(),settings.changepicturecallback(lbit_comments_count),w=!0}),u(),o.ajaxcallback()}function l(i){$pp_pic_holder.stop().find("object,embed,video").css("visibility","hidden"),videoJsObj&&videoJsObj.pause(),$pp_pic_holder.find(".pp_fade").fadeOut(settings.animation_speed,function(){videoJsObj&&(videoJsObj.dispose(),videoJsObj=null),e(".pp_loaderIcon").show(),i()})}function n(i){i>1?e(".pp_nav").show():e(".pp_nav").hide()}function r(e,i){if(resized=!1,c(e,i),imageWidth=e,imageHeight=i,(P>I||k>z)&&doresize&&settings.allow_resize&&!$){for(resized=!0,fitting=!1;!fitting;)P>I?(imageWidth=I-200,imageHeight=i/e*imageWidth):k>z?(imageHeight=z-200,imageWidth=e/i*imageHeight):fitting=!0,k=imageHeight,P=imageWidth;(P>I||k>z)&&r(P,k),c(imageWidth,imageHeight)}return{width:"100%",height:"100%",containerHeight:Math.floor(k),containerWidth:Math.floor(P)+2*settings.horizontal_padding,contentHeight:Math.floor(y),contentWidth:Math.floor(b),resized:resized}}function d(e,i){if(resized=!1,c(e,i),imageWidth=e,imageHeight=i,P>I&&doresize&&settings.allow_resize&&!$){for(resized=!0,fitting=!1;!fitting;)P>I?(imageWidth=I-200,imageHeight=i/e*imageWidth):fitting=!0,k=imageHeight,P=imageWidth;P>I&&d(P,k),c(imageWidth,z-150)}return{width:Math.floor(imageWidth),height:Math.floor(imageHeight),visibleHeight:z-150,containerHeight:Math.floor(k),containerWidth:Math.floor(P)+2*settings.horizontal_padding,contentHeight:Math.floor(y),contentWidth:Math.floor(b),resized:resized}}function c(i,t){i=.95*e(window).width(),t=.8*e(window).height(),$pp_details=$pp_pic_holder.find(".pp_details"),$pp_details.width(i-30),detailsHeight=parseFloat($pp_details.css("marginTop"))+parseFloat($pp_details.css("marginBottom")),$pp_details=$pp_details.clone().addClass(settings.theme).width(i).appendTo(e("body")).css({position:"absolute",top:-1e4}),detailsHeight+=$pp_details.height(),detailsHeight=detailsHeight<=34?36:detailsHeight,$pp_details.remove(),$pp_title=$pp_pic_holder.find(".ppt"),$pp_title.width(i),titleHeight=parseFloat($pp_title.css("marginTop"))+parseFloat($pp_title.css("marginBottom")),$pp_title=$pp_title.clone().appendTo(e("body")).css({position:"absolute",top:-1e4}),titleHeight+=$pp_title.height(),$pp_title.remove(),y=t+detailsHeight,b=i,k=y+titleHeight+$pp_pic_holder.find(".pp_top").height()+$pp_pic_holder.find(".pp_bottom").height(),P=i}function h(e){return e.match(/\biframe=true\b/i)?"iframe":e.match(/\.jpg/i)||e.match(/\.png/i)||e.match(/\.gif/i)||e.match(/\.webp/i)?"image":e.match(/\.js/i)?"javascript":e.match(/\.swf/i)?"flash":e.match(/\.pdf/i)||e.match(/\.ppt/i)||e.match(/\.doc/i)||e.match(/\.docx/i)||e.match(/\.pptx/i)?"embed-viewer":e.match(/\.mp4/i)||e.match(/\.webm/i)||e.match(/\.flv/i)||e.match(/\.m4v/i)?"video":e.match(/\.mov/i)?"video":e.match(/\.f4m/i)||e.match(/rtmp:\/\//i)?"rtmp-live":e.match(/\.m3u8/i)?"hls-live":e.match(/\.mp3/i)||e.match(/\.m4a/i)?"audio":e.match(/\bajax=true\b/i)?"ajax":e.match(/\bcustom=true\b/i)?"custom":e.match(/youtube\.com\/watch/i)||e.match(/youtu\.be/i)?"youtube":e.match(/vimeo\.com/i)?"vimeo":e.match(/annotag\.tv/i)?"annotag":e.match(/timetag\.tv/i)?"timetag":"#ss"==e.substr(0,3)?"slideshare":"#if"==e.substr(0,3)?"iframe_embed":"#"==e.substr(0,1)?"inline":"image"}function _(){if(doresize&&"undefined"!=typeof $pp_pic_holder){if(scroll_pos=m(),contentHeight=$pp_pic_holder.height(),contentwidth=$pp_pic_holder.width(),projectedTop=z/2+scroll_pos.scrollTop-contentHeight/2,projectedTop<0&&(projectedTop=0),contentHeight>z)return;$pp_pic_holder.css({top:projectedTop,left:I/2+scroll_pos.scrollLeft-contentwidth/2})}}function m(){return self.pageYOffset?{scrollTop:self.pageYOffset,scrollLeft:self.pageXOffset}:document.documentElement&&document.documentElement.scrollTop?{scrollTop:document.documentElement.scrollTop,scrollLeft:document.documentElement.scrollLeft}:document.body?{scrollTop:document.body.scrollTop,scrollLeft:document.body.scrollLeft}:void 0}function g(){z=e(window).height()-20,I=e(window).width(),"undefined"!=typeof $pp_overlay&&$pp_overlay.height(e(document).height()).width(I),f=r(100,100),_(),p()}function u(){isSet&&settings.overlay_gallery&&"image"==h(pp_images[set_position])?(itemWidth=57,navWidth="facebook"==settings.theme||"pp_default"==settings.theme?50:30,itemsPerPage=Math.floor((f.containerWidth-100-navWidth)/itemWidth),itemsPerPage=itemsPerPage<pp_images.length?itemsPerPage:pp_images.length,totalPage=Math.ceil(pp_images.length/itemsPerPage)-1,0==totalPage?(navWidth=0,$pp_gallery.find(".pp_arrow_next,.pp_arrow_previous").hide()):$pp_gallery.find(".pp_arrow_next,.pp_arrow_previous").show(),galleryWidth=itemsPerPage*itemWidth,fullGalleryWidth=pp_images.length*itemWidth,$pp_gallery.css("margin-left",-(galleryWidth/2+navWidth/2)).find("div:first").width(galleryWidth+5).find("ul").width(fullGalleryWidth).find("li.selected").removeClass("selected"),goToPage=Math.floor(set_position/itemsPerPage)<totalPage?Math.floor(set_position/itemsPerPage):totalPage,e.prettyPhoto.changeGalleryPage(goToPage),$pp_gallery_li.filter(":eq("+set_position+")").addClass("selected")):$pp_pic_holder.find(".pp_content").unbind("mouseenter mouseleave")}function v(){settings.social_tools&&(facebook_like_link=settings.social_tools.replace("{location_href}",encodeURIComponent(location.href)));var i=settings.markup.replace("{pp_social}",""),t=lbit_discuss_url;if("disable"===lbit_discuss_url&&(t="about:blank"),i=settings.markup.replace("{panel_block}",'<iframe class="embed-responsive-item" id="lbit-discuss-frame" width="100%" height="100%" src="'+t+'" frameborder="0" />'),e("body").append(i),$pp_pic_holder=e(".pp_pic_holder"),$ppt=e(".ppt"),$pp_overlay=e("div.pp_overlay"),isSet&&settings.overlay_gallery){currentGalleryPage=0,toInject="";for(var a=0;a<pp_images.length;a++)pp_images[a].match(/\b(jpg|jpeg|png|gif)\b/gi)?(classname="",img_src=pp_images[a]):(classname="",img_src="/images/article_icon.png"),toInject+="<li class='"+classname+"'><a href='#'><img src='"+img_src+"' width='50' alt='' /></a></li>";toInject=settings.gallery_markup.replace(/{gallery}/g,toInject),$pp_pic_holder.find("#pp_full_res").after(toInject),$pp_gallery=e(".pp_pic_holder .pp_gallery"),$pp_gallery_li=$pp_gallery.find("li"),$pp_gallery.find(".pp_arrow_next").click(function(){return e.prettyPhoto.changeGalleryPage("next"),e.prettyPhoto.stopSlideshow(),!1}),$pp_gallery.find(".pp_arrow_previous").click(function(){return e.prettyPhoto.changeGalleryPage("previous"),e.prettyPhoto.stopSlideshow(),!1}),$pp_pic_holder.find(".pp_content").hover(function(){$pp_pic_holder.find(".pp_gallery:not(.disabled)").fadeIn()},function(){$pp_pic_holder.find(".pp_gallery:not(.disabled)").fadeOut()}),itemWidth=57,$pp_gallery_li.each(function(i){e(this).find("a").click(function(){return e.prettyPhoto.changePage(i),e.prettyPhoto.stopSlideshow(),!1})})}settings.slideshow&&($pp_pic_holder.find(".pp_nav").prepend('<a href="#" class="pp_play">Play</a>'),$pp_pic_holder.find(".pp_nav .pp_play").click(function(){return e.prettyPhoto.startSlideshow(),!1})),$pp_pic_holder.attr("class","pp_pic_holder "+settings.theme),$pp_overlay.css({opacity:0,height:e(document).height(),width:e(window).width()}).bind("click",function(){pp_settings.modal||e.prettyPhoto.close()}),e("a.pp_close").bind("click",function(){return e.prettyPhoto.close(),!1}),settings.allow_expand&&e("a.pp_expand").bind("click",function(){return e(this).hasClass("pp_expand")?(e(this).removeClass("pp_expand").addClass("pp_contract"),doresize=!1):(e(this).removeClass("pp_contract").addClass("pp_expand"),doresize=!0),l(function(){e.prettyPhoto.open()}),!1}),$pp_pic_holder.find(".pp_previous, .pp_nav .pp_arrow_previous").bind("click",function(){return e.prettyPhoto.changePage("previous"),e.prettyPhoto.stopSlideshow(),!1}),$pp_pic_holder.find(".pp_next, .pp_nav .pp_arrow_next").bind("click",function(){return e.prettyPhoto.changePage("next"),e.prettyPhoto.stopSlideshow(),!1}),_()}o=jQuery.extend({hook:"rel",animation_speed:"fast",ajaxcallback:function(){},slideshow:!1,autoplay_slideshow:!1,opacity:.8,show_title:!1,allow_resize:!0,allow_expand:!1,default_width:620,default_height:500,counter_separator_label:"/",theme:"light_square",horizontal_padding:5,hideflash:!1,wmode:"opaque",autoplay:!0,modal:!1,deeplinking:!1,overlay_gallery:!0,overlay_gallery_max:30,keyboard_shortcuts:!1,changepicturecallback:function(i){function t(i,t){!t&&i&&(i.stopPropagation(),t=e(i.currentTarget).prop("id")),"show"!=t&&("notesPanel"===t&&"disable"!==lbit_notes_url?e("#lbit-discuss-frame").prop("src",lbit_notes_url):"discussPanel"===t&&"disable"!==lbit_discuss_url&&e("#lbit-discuss-frame").prop("src",lbit_discuss_url),s.open("east"))}e(".jquery-layout")&&e(".jquery-layout").hasClass("hide")&&e(".jquery-layout").removeClass("hide"),s=e(".jquery-layout").layout({zIndex:1050,resizerDblClickToggle:!1,slidable:!1,livePaneResizing:!1,spacing_open:10,east__initClosed:!0,spacing_closed:10,east__spacing_closed:50,east__togglerLength_closed:140,east__togglerAlign_closed:"top",east__togglerContent_closed:"<ul class='panels'><li id='discussPanel' title='Discuss'><i class='fa fa-comments' style='font-size: 1.8em;'></i> <span style='font-size: 1.8em;' class='comments_count_class'></span><br/><span style='font-size: 0.8em'>Discuss</span></li><li id='notesPanel' title='Notes'><i class='fa fa-pencil' style='font-size: 1.8em;'></i> <span style='font-size: 1.8em;' class='notes_class'></span><br/><span style='font-size: 0.8em'>Notes</span></li></ul>",east__togglerContent_open:"<i class='fa fa-chevron-right' style='font-size: 1.5em;'></i>",east__minSize:"40%",east__size:"50%",east__resizerTip:"Resize",east__resizerTip_closed:"",east__sliderTip:"",east__resizerCursor:"w-resize",east__sliderTip_closed:"",east__togglerTip_open:"Close panel",center__minSize:"30%",maskContents:!0,maskPanesEarly:!0,showErrorMessages:!1}),s.togglers.east.unbind("click").find("#discussPanel").click(t).end().find("#notesPanel").click(t).end(),e(".ui-layout-toggler").click(function(){s.toggle("east")}),"disable"===lbit_discuss_url?s.togglers.east.find("#discussPanel").hide():s.togglers.east.find("#discussPanel").show(),"disable"===lbit_notes_url?s.togglers.east.find("#notesPanel").hide():s.togglers.east.find("#notesPanel").show(),i&&0!=i&&e(".jquery-layout").find(".comments_count_class").text(i),openPanel&&t(null,openPanel)},callback:function(){},ie6_fallback:!0,markup:'<div class="pp_pic_holder">             <div class="ppt">&nbsp;</div>             <div class="pp_top">               <div class="pp_left"></div>               <div class="pp_middle"></div>               <div class="pp_right"></div>                             <a class="pp_close" href="#"></a>             </div>             <div class="pp_content_container">               <div class="pp_left">               <div class="pp_right">                                 <div class="pp_loaderIcon"></div>                 <div class="pp_content jquery-layout hide">                                     <div class="ui-layout-center">                       <div class="pp_fade">                         <a href="#" class="pp_expand" title="Expand the image">Expand</a>                                             <div class="pp_hoverContainer">                                                 <a class="pp_next" href="#">next</a>                                                 <a class="pp_previous" href="#">previous</a>                                             </div>                         <div id="pp_full_res" class="embed-responsive embed-responsive-16by9"></div>                                         </div>                                     </div>                                     <div class="ui-layout-east">                                       {panel_block}                                     </div>                                     <div class="hide">                       <div class="pp_details hidden-xs hidden-sm">                         <p class="pp_description"></p>                       </div>                                     </div>                                 </div>               </div>               </div>                             </div>             <div class="pp_bottom">               <div class="pp_left"></div>               <div class="pp_middle"></div>               <div class="pp_right"></div>             </div>           </div>           <div class="pp_overlay"></div>',gallery_markup:'<div class="pp_gallery">                 <a href="#" class="pp_arrow_previous">Previous</a>                 <div>                   <ul>                     {gallery}                   </ul>                 </div>                 <a href="#" class="pp_arrow_next">Next</a>               </div>',image_markup:'<img class="img-responsive" id="fullResImage" src="{path}" />',flash_markup:'<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" width="{width}" height="{height}"><param name="wmode" value="{wmode}" /><param name="allowfullscreen" value="true" /><param name="allowscriptaccess" value="always" /><param name="movie" value="{path}" /><embed src="{path}" type="application/x-shockwave-flash" allowfullscreen="true" allowscriptaccess="always" width="{width}" height="{height}" wmode="{wmode}"></embed></object>',quicktime_markup:'<object classid="clsid:02BF25D5-8C17-4B23-BC80-D3488ABDDC6B" codebase="http://www.apple.com/qtactivex/qtplugin.cab" height="{height}" width="{width}"><param name="src" value="{path}"><param name="autoplay" value="{autoplay}"><param name="type" value="video/quicktime"><embed src="{path}" height="{height}" width="{width}" autoplay="{autoplay}" type="video/quicktime" pluginspage="http://www.apple.com/quicktime/download/"></embed></object>',iframe_markup:'<div class="media-wrapper embed-responsive embed-responsive-16by9"><div class="media-container"><div class="media-shadow"><iframe class="media-frame embed-responsive-item" id="media-frame" src ="{path}" width="{width}" height="{height}" allowfullscreen mozallowfullscreen webkitallowfullscreen oallowfullscreen msallowfullscreen frameborder="no"></iframe></div></div></div>',ss_inline_markup:'<div class="media-wrapper embed-responsive embed-responsive-16by9"><div class="media-container"><div class="media-shadow pp_inline">{content}</div></div></div>',if_inline_markup:'<div class="media-wrapper"><div class="media-container"><div class="media-shadow pp_inline">{content}</div></div></div>',inline_markup:'<div class="pp_inline" style="max-height: 650px; overflow-y: scroll; overflow-x: hidden;">{content}</div>',custom_markup:"",eviewer_markup:'<div class="media-wrapper"><div class="media-container"><div class="media-shadow"><iframe class="embed-responsive-item" src="https://view.officeapps.live.com/op/embed.aspx?src={path}" width="{width}" height="{height}" frameborder="no" allowfullscreen mozallowfullscreen webkitallowfullscreen oallowfullscreen msallowfullscreen></iframe></div></div></div>',annotag_markup:'<div class="media-wrapper"><div class="media-container"><div class="media-shadow"><iframe class="media-frame embed-responsive-item" src ="https://www.annotag.tv/learningtechnologies/play/{embed}?embed=1&autoplay=1" width="{width}" height="{height}" frameborder="no" allowfullscreen mozallowfullscreen webkitallowfullscreen oallowfullscreen msallowfullscreen></iframe></div></div></div>',video_markup:'<div class="media-wrapper"><div class="media-container"><div class="media-shadow"><video x-webkit-airplay="allow" id="ownvideo-{vid}" class="video-js vjs-default-skin embed-responsive-item" autoplay="autoplay" controls poster="" width="{width}" height="{height}" data-setup=\'{"nativeControlsForTouch": true}\'><source src="{path}" type="video/{type}" /><track kind="chapters" src="{chapter_path}" srclang="en" label="English" default></video></div></div></div>',live_video_markup:'<div class="media-wrapper"><div class="media-container"><div class="media-shadow"><video x-webkit-airplay="allow" id="livevideo-{vid}" class="video-js vjs-default-skin embed-responsive-item" autoplay="autoplay" controls poster="" width="{width}" height="{height}" data-setup=\'{ "techOrder": ["flash"] }\'><source src="{path}" type="rtmp/mp4" /></video></div></div></div>',hls_video_markup:'<div class="media-wrapper"><div class="media-container"><div class="media-shadow"><video x-webkit-airplay="allow" id="hlslive-{vid}" class="video-js vjs-default-skin embed-responsive-item" autoplay="autoplay" controls poster="" width="{width}" height="{height}"><source src="{path}" type="video/mp4" /></video></div></div></div>',audio_markup:'<div class="media-wrapper"><div class="media-container"><div class="media-shadow"><audio id="ownaudio-{aid}" class="audio-js embed-responsive-item" src="{path}" preload="auto"></audio></div></div></div>',youtube_video_markup:'<div class="media-wrapper"><div class="media-container"><div class="media-shadow"><video x-webkit-airplay="allow" id="youtube-{vid}" class="video-js vjs-default-skin embed-responsive-item" controls poster="" width="{width}" height="{height}"><source src="{path}" type="video/youtube" /><track kind="chapters" src="{chapter_path}" srclang="en" label="English" default></video></div></div></div>',vimeo_video_markup:'<div class="media-wrapper"><div class="media-container"><div class="media-shadow"><video x-webkit-airplay="allow" id="vimeo-{vid}" class="video-js vjs-default-skin embed-responsive-item" controls poster="" width="{width}" height="{height}"><source src="{path}" type="video/vimeo" /><track kind="chapters" src="{chapter_path}" srclang="en" label="English" default></video></div></div></div>',social_tools:'<div class="twitter"><a href="http://twitter.com/share" class="twitter-share-button" data-count="none">Tweet</a><script type="text/javascript" src="http://platform.twitter.com/widgets.js"></script></div><div class="facebook"><iframe src="//www.facebook.com/plugins/like.php?locale=en_US&href={location_href}&amp;layout=button_count&amp;show_faces=true&amp;width=500&amp;action=like&amp;font&amp;colorscheme=light&amp;height=23" scrolling="no" frameborder="0" style="border:none; overflow:hidden; width:500px; height:23px;" allowTransparency="true"></iframe></div>'},o);var f,w,y,b,k,P,x,j=this,$=!1,z=e(window).height(),I=e(window).width();return doresize=!0,scroll_pos=m(),o.keyboard_shortcuts&&e(document).unbind("keydown.prettyphoto").bind("keydown.prettyphoto",function(i){if("undefined"!=typeof $pp_pic_holder&&$pp_pic_holder.is(":visible"))switch(i.keyCode){case 37:e.prettyPhoto.changePage("previous"),i.preventDefault();break;case 39:e.prettyPhoto.changePage("next"),i.preventDefault();break;case 27:settings.modal||e.prettyPhoto.close(),i.preventDefault()}}),e.prettyPhoto.initialize=function(){return settings=o,"pp_default"==settings.theme&&(settings.horizontal_padding=16),theRel=e(this).attr(settings.hook),galleryRegExp=/\[(?:.*)\]/,isSet=galleryRegExp.exec(theRel)?!0:!1,pp_images=isSet?jQuery.map(j,function(i){return-1!=e(i).attr(settings.hook).indexOf(theRel)?e(i).attr("href"):void 0}):e.makeArray(e(this).attr("href")),pp_titles=isSet?jQuery.map(j,function(i){return-1!=e(i).attr(settings.hook).indexOf(theRel)?e(i).find("img").attr("alt")?e(i).find("img").attr("alt"):"":void 0}):e.makeArray(e(this).find("img").attr("alt")),pp_descriptions=isSet?jQuery.map(j,function(i){return-1!=e(i).attr(settings.hook).indexOf(theRel)?e(i).attr("data-description")?e(i).attr("data-description"):"":void 0}):e.makeArray(e(this).attr("data-description")),lbit_titles=isSet?jQuery.map(j,function(i){return-1!=e(i).attr(settings.hook).indexOf(theRel)?e(i).attr("data-title")?e(i).attr("data-title"):"":void 0}):e.makeArray(e(this).attr("data-title")),lbit_actions=isSet?jQuery.map(j,function(i){return-1!=e(i).attr(settings.hook).indexOf(theRel)?e(i).attr("data-action")?e(i).attr("data-action"):"":void 0}):e.makeArray(e(this).attr("data-action")),lbit_comments_counts=isSet?jQuery.map(j,function(i){return-1!=e(i).attr(settings.hook).indexOf(theRel)?e(i).attr("data-comments_count")?e(i).attr("data-comments_count"):"":void 0}):e.makeArray(e(this).attr("data-comments_count")),lbit_ids=isSet?jQuery.map(j,function(i){return-1!=e(i).attr(settings.hook).indexOf(theRel)?e(i).attr("data-lbit-id")?e(i).attr("data-lbit-id"):"":void 0}):e.makeArray(e(this).attr("data-lbit-id")),lbit_discuss_urls=isSet?jQuery.map(j,function(i){return-1!=e(i).attr(settings.hook).indexOf(theRel)?e(i).attr("data-lbit-durl")?e(i).attr("data-lbit-durl"):"":void 0}):e.makeArray(e(this).attr("data-lbit-durl")),lbit_notes_urls=isSet?jQuery.map(j,function(i){return-1!=e(i).attr(settings.hook).indexOf(theRel)?e(i).attr("data-lbit-nurl")?e(i).attr("data-lbit-nurl"):"":void 0}):e.makeArray(e(this).attr("data-lbit-nurl")),topic_ids=isSet?jQuery.map(j,function(i){return-1!=e(i).attr(settings.hook).indexOf(theRel)?e(i).attr("data-topic-id")?e(i).attr("data-topic-id"):"":void 0}):e.makeArray(e(this).attr("data-topic-id")),video_starts=isSet?jQuery.map(j,function(i){return-1!=e(i).attr(settings.hook).indexOf(theRel)?e(i).attr("data-start")?e(i).attr("data-start"):"":void 0}):e.makeArray(e(this).attr("data-start")),video_ends=isSet?jQuery.map(j,function(i){return-1!=e(i).attr(settings.hook).indexOf(theRel)?e(i).attr("data-end")?e(i).attr("data-end"):"":void 0}):e.makeArray(e(this).attr("data-end")),openPanels=isSet?jQuery.map(j,function(i){return-1!=e(i).attr(settings.hook).indexOf(theRel)?e(i).attr("data-openPanel")?e(i).attr("data-openPanel"):"":void 0}):e.makeArray(e(this).attr("data-openPanel")),vid=Math.floor(101*Math.random()),aid=Math.floor(201*Math.random()),videoJsObj=null,fileType="",pp_images.length>settings.overlay_gallery_max&&(settings.overlay_gallery=!1),set_position=jQuery.inArray(e(this).attr("href"),pp_images),rel_index=isSet?set_position:e("a["+settings.hook+"^='"+theRel+"']").index(e(this)),lbit_title=lbit_titles&&lbit_titles.length?lbit_titles[set_position]:null,lbit_id=lbit_ids&&lbit_ids.length?lbit_ids[set_position]:null,lbit_discuss_url=lbit_discuss_urls&&lbit_discuss_urls.length?lbit_discuss_urls[set_position]:null,lbit_notes_url=lbit_notes_urls&&lbit_notes_urls.length?lbit_notes_urls[set_position]:null,topic_id=topic_ids&&topic_ids.length?topic_ids[set_position]:null,lbit_action=lbit_actions&&lbit_actions.length?lbit_actions[set_position]:null,lbit_comments_count=lbit_comments_counts&&lbit_comments_counts.length?lbit_comments_counts[set_position]:null,video_start=video_starts&&video_starts.length?parseInt(video_starts[set_position],10):null,video_end=video_ends&&video_ends.length?parseInt(video_ends[set_position],10):null,openPanel=openPanels&&openPanels.length?openPanels[set_position]:null,v(this),settings.allow_resize&&(e(window).bind("scroll.prettyphoto",function(){_()}),e(window).on("debouncedresize",function(){g()})),e.prettyPhoto.open(),!1},e.prettyPhoto.open=function(i){"undefined"==typeof settings&&(settings=o,pp_images=e.makeArray(arguments[0]),pp_titles=e.makeArray(arguments[1]?arguments[1]:""),pp_descriptions=e.makeArray(arguments[2]?arguments[2]:""),isSet=pp_images.length>1?!0:!1,set_position=arguments[3]?arguments[3]:0,v(i.target)),window.isLearnbitModalOpen=!0,settings.hideflash&&e("object,embed,iframe[src*=youtube],iframe[src*=vimeo]").css("visibility","hidden"),n(e(pp_images).size()),e(".pp_loaderIcon").show(),settings.deeplinking&&t(),settings.social_tools&&(facebook_like_link=settings.social_tools.replace("{location_href}",encodeURIComponent(location.href)),$pp_pic_holder.find(".pp_social").html(facebook_like_link)),$ppt.is(":hidden")&&$ppt.css("opacity",0).show(),$pp_overlay.show().fadeTo(settings.animation_speed,settings.opacity),$pp_pic_holder.find(".currentTextHolder").text(set_position+1+settings.counter_separator_label+e(pp_images).size()),"undefined"!=typeof pp_descriptions[set_position]&&""!=pp_descriptions[set_position]?$pp_pic_holder.find(".pp_description").show().html(unescape(pp_descriptions[set_position])):$pp_pic_holder.find(".pp_description").hide(),movie_width=parseFloat(a("width",pp_images[set_position]))?a("width",pp_images[set_position]):settings.default_width.toString(),movie_height=parseFloat(a("height",pp_images[set_position]))?a("height",pp_images[set_position]):settings.default_height.toString(),$=!1,-1!=movie_height.indexOf("%")&&(movie_height=parseFloat(e(window).height()*parseFloat(movie_height)/100-150),$=!0),-1!=movie_width.indexOf("%")&&(movie_width=parseFloat(e(window).width()*parseFloat(movie_width)/100-150),$=!0);var s="/lbit/tracks/chapters/"+lbit_id;return $pp_pic_holder.fadeIn(function(){var i=pp_titles[set_position]||lbit_titles[set_position];switch($ppt.html(settings.show_title&&""!=i&&"undefined"!=typeof i?unescape(i):"&nbsp;"),imgPreloader="",skipInjection=!1,fileType=h(pp_images[set_position]),fileType){case"image":imgPreloader=new Image,nextImage=new Image,isSet&&set_position<e(pp_images).size()-1&&(nextImage.src=pp_images[set_position+1]),prevImage=new Image,isSet&&pp_images[set_position-1]&&(prevImage.src=pp_images[set_position-1]),$pp_pic_holder.find("#pp_full_res")[0].innerHTML=settings.image_markup.replace(/{path}/g,pp_images[set_position]),imgPreloader.onload=function(){imgPreloader.height/2>imgPreloader.width?(f=d(imgPreloader.width,imgPreloader.height),$pp_pic_holder.find("div.media-wrapper").css("height",f.visibleHeight)):f=r(imgPreloader.width,imgPreloader.height),p()},imgPreloader.onerror=function(){alert("Image cannot be loaded. Make sure the path is correct and image exist."),e.prettyPhoto.close()},imgPreloader.src=pp_images[set_position];break;case"youtube":f=r(movie_width,movie_height),movie_id=a("v",pp_images[set_position]),""==movie_id&&(movie_id=pp_images[set_position].split("youtu.be/"),movie_id=movie_id[1],movie_id.indexOf("?")>0&&(movie_id=movie_id.substr(0,movie_id.indexOf("?"))),movie_id.indexOf("&")>0&&(movie_id=movie_id.substr(0,movie_id.indexOf("&")))),movie="https://www.youtube.com/embed/"+movie_id,movie+="?modestbranding=1&autohide=1&rel=0&showinfo=0&theme=light&iv_load_policy=3",movie+="&autoplay=1",toInject=settings.youtube_video_markup.replace(/{width}/g,f.width).replace(/{height}/g,f.height).replace(/{path}/g,movie).replace(/{vid}/g,vid).replace(/{chapter_path}/g,s);break;case"vimeo":f=r(movie_width,movie_height),movie_id=pp_images[set_position],vimeo_width=f.width+"/embed/?moog_width="+f.width,toInject=settings.vimeo_video_markup.replace(/{width}/g,vimeo_width).replace(/{height}/g,f.height).replace(/{path}/g,movie_id).replace(/{vid}/g,vid).replace(/{chapter_path}/g,s);break;case"quicktime":f=r(movie_width,movie_height),f.height+=15,f.contentHeight+=15,f.containerHeight+=15,toInject=settings.quicktime_markup.replace(/{width}/g,f.width).replace(/{height}/g,f.height).replace(/{wmode}/g,settings.wmode).replace(/{path}/g,pp_images[set_position]).replace(/{autoplay}/g,settings.autoplay);break;case"flash":f=r(movie_width,movie_height),flash_vars=pp_images[set_position],flash_vars=flash_vars.substring(pp_images[set_position].indexOf("flashvars")+10,pp_images[set_position].length),filename=pp_images[set_position],filename=filename.substring(0,filename.indexOf("?")),toInject=settings.flash_markup.replace(/{width}/g,f.width).replace(/{height}/g,f.height).replace(/{wmode}/g,settings.wmode).replace(/{path}/g,filename+"?"+flash_vars);break;case"iframe":f=r(movie_width,movie_height),frame_url=pp_images[set_position],frame_url=frame_url.substr(0,frame_url.indexOf("iframe")-1),frame_url=frame_url+"?topic_id="+topic_id,toInject=settings.iframe_markup.replace(/{width}/g,f.width).replace(/{height}/g,f.height).replace(/{path}/g,frame_url);break;case"ajax":doresize=!1,f=r(movie_width,movie_height),doresize=!0,skipInjection=!0,e.get(pp_images[set_position],function(e){toInject=settings.inline_markup.replace(/{content}/g,e),$pp_pic_holder.find("#pp_full_res")[0].innerHTML=toInject,p()});break;case"custom":f=r(movie_width,movie_height),toInject=settings.custom_markup;break;case"embed-viewer":f=r(900,760),frame_url=encodeURIComponent(pp_images[set_position]),toInject=settings.eviewer_markup.replace(/{width}/g,f.width).replace(/{height}/g,f.height).replace(/{path}/g,frame_url);break;case"slideshare":myClone=e(pp_images[set_position]).clone().append('<br clear="all" />').css({width:settings.default_width}).wrapInner('<div id="pp_full_res"><div class="pp_inline"></div></div>').appendTo(e("body")).show(),doresize=!1,f=r(e(myClone).width(),e(myClone).height()),doresize=!0,e(myClone).remove(),toInject=settings.ss_inline_markup.replace(/{content}/g,e(pp_images[set_position]).html());break;case"iframe_embed":myClone=e(pp_images[set_position]).clone().append('<br clear="all" />').css({width:settings.default_width}).wrapInner('<div id="pp_full_res"><div class="pp_inline"></div></div>').appendTo(e("body")).show(),doresize=!1,f=r(e(myClone).width()-60,e(myClone).height()),doresize=!0,e(myClone).remove(),toInject=settings.if_inline_markup.replace(/{content}/g,e(pp_images[set_position]).html());break;case"inline":myClone=e(pp_images[set_position]).clone().append('<br clear="all" />').css({width:"80%"}).css({overflow:"scroll"}).wrapInner('<div id="pp_full_res"><div class="pp_inline"></div></div>').appendTo(e("body")).show(),doresize=!1,f=r(e(myClone).width(),650),doresize=!0,e(myClone).remove(),toInject=settings.inline_markup.replace(/{content}/g,e(pp_images[set_position]).html());break;case"timetag":case"annotag":doresize=!1,f=r(980,450),movie_id=a("id",pp_images[set_position]),toInject=settings.annotag_markup.replace(/{embed}/g,movie_id).replace(/{width}/g,f.width).replace(/{height}/g,f.height),doresize=!0;break;case"video":doresize=!1;var t="mp4";-1!=pp_images[set_position].indexOf("flv")?t="flv":-1!=pp_images[set_position].indexOf("webm")&&(t="webm");var o=encodeURIComponent(pp_images[set_position]);f=r(movie_width,movie_height),toInject=settings.video_markup.replace(/{width}/g,f.width).replace(/{height}/g,f.height).replace(/{path}/g,pp_images[set_position]).replace(/{vid}/g,vid).replace(/{type}/g,t).replace(/{url_escaped}/g,o).replace(/{chapter_path}/g,s),doresize=!0;break;case"rtmp-live":doresize=!1;var o=encodeURIComponent(pp_images[set_position]);f=r(movie_width,movie_height),f.height+=15,f.contentHeight+=15,f.containerHeight+=15,toInject=settings.live_video_markup.replace(/{width}/g,f.width).replace(/{height}/g,f.height).replace(/{path}/g,pp_images[set_position]).replace(/{vid}/g,vid).replace(/{url_escaped}/g,o),doresize=!0;break;case"hls-live":doresize=!1;var o=encodeURIComponent(pp_images[set_position]);

f=r(movie_width,movie_height),f.height+=15,f.contentHeight+=15,f.containerHeight+=15,toInject=settings.hls_video_markup.replace(/{width}/g,f.width).replace(/{height}/g,f.height).replace(/{path}/g,pp_images[set_position]).replace(/{vid}/g,vid).replace(/{url_escaped}/g,o),doresize=!0;break;case"audio":doresize=!1,f=r(460,40),toInject=settings.audio_markup.replace(/{width}/g,f.width).replace(/{height}/g,f.height).replace(/{path}/g,pp_images[set_position]).replace(/{aid}/g,aid).replace(/{path}/g,pp_images[set_position]),doresize=!0}if(!imgPreloader&&!skipInjection){if($pp_pic_holder.find("#pp_full_res")[0].innerHTML=toInject,"video"==fileType)videoJsObj=videojs("ownvideo-"+vid,{controls:!0,autoplay:!0,preload:"auto",lbit_id:lbit_id,topic_id:topic_id,plugins:{autoResume:{namespace:"namespace",lbit_id:lbit_id,topic_id:topic_id,start:video_start,end:video_end,autoplay:!0}}},function(){this.videoAnalytics({lbit_id:lbit_id,topic_id:topic_id}),this.overlay({content:'<a href="http://www.colearnr.com" target="_new"><img src="/images/logo-mini.png" width="64px" height="auto" /></a>',overlays:[{start:"pause",end:"play",align:"top-right"}]}),this.hotkeys()});else if("youtube"==fileType||"vimeo"==fileType){var l={controls:!0,autoplay:!0,preload:"auto",techOrder:[fileType],src:pp_images[set_position],plugins:{autoResume:{namespace:"namespace",lbit_id:lbit_id,topic_id:topic_id,start:video_start,end:video_end,autoplay:!0}}};"youtube"==fileType&&(l.ytcontrols=!1,l.quality="480p",l.autoplay=!0,l.playsInline=!0,l.forceSSL=!0,l.forceHTML5=!0),l.start=video_start,l.end=video_end,l.width=f.width,l.height=f.height,l.lbit_id=lbit_id,l.topic_id=topic_id,videoJsObj=videojs(fileType+"-"+vid,l,function(){this.videoAnalytics({lbit_id:lbit_id,topic_id:topic_id}),this.overlay({content:'<a href="http://www.colearnr.com" target="_new"><img src="/images/logo-mini.png" width="64px" height="auto" /></a>',overlays:[{start:"pause",end:"play",align:"top-right"}]}),this.hotkeys()})}else"audio"==fileType?window.audiojs&&audiojs.events.ready(function(){audiojs.createAll()}):"rtmp-live"==fileType?videoJsObj=videojs("livevideo-"+vid,{controls:!0,autoplay:!0,preload:"auto",lbit_id:lbit_id,topic_id:topic_id},function(){}):"hls-live"==fileType&&(videoJsObj=videojs("hlslive-"+vid,{controls:!0,autoplay:!0,preload:"auto",lbit_id:lbit_id,topic_id:topic_id,plugins:{autoResume:{namespace:"namespace",lbit_id:lbit_id,topic_id:topic_id,start:video_start,end:video_end,autoplay:!0}}},function(){this.videoAnalytics({lbit_id:lbit_id,topic_id:topic_id}),this.overlay({content:'<a href="http://www.colearnr.com" target="_new"><img src="/images/logo-mini.png" width="64px" height="auto" /></a>',overlays:[{start:"pause",end:"play",align:"top-right"}]}),this.hotkeys()}));p()}}),!1},e.prettyPhoto.changePage=function(i){currentGalleryPage=0,"previous"==i?(set_position--,set_position<0&&(set_position=e(pp_images).size()-1)):"next"==i?(set_position++,set_position>e(pp_images).size()-1&&(set_position=0)):set_position=i,rel_index=set_position,lbit_id=lbit_ids[rel_index],topic_id=topic_ids[rel_index],lbit_title=lbit_titles[rel_index],lbit_discuss_url=lbit_discuss_urls[rel_index],lbit_notes_url=lbit_notes_urls[rel_index],lbit_id=lbit_ids[rel_index],doresize||(doresize=!0),settings.allow_expand&&e(".pp_contract").removeClass("pp_contract").addClass("pp_expand"),l(function(){e.prettyPhoto.open()})},e.prettyPhoto.changeGalleryPage=function(e){"next"==e?(currentGalleryPage++,currentGalleryPage>totalPage&&(currentGalleryPage=0)):"previous"==e?(currentGalleryPage--,currentGalleryPage<0&&(currentGalleryPage=totalPage)):currentGalleryPage=e,slide_speed="next"==e||"previous"==e?settings.animation_speed:0,slide_to=currentGalleryPage*itemsPerPage*itemWidth,$pp_gallery.find("ul").animate({left:-slide_to},slide_speed)},e.prettyPhoto.startSlideshow=function(){"undefined"==typeof x?($pp_pic_holder.find(".pp_play").unbind("click").removeClass("pp_play").addClass("pp_pause").click(function(){return e.prettyPhoto.stopSlideshow(),!1}),x=setInterval(e.prettyPhoto.startSlideshow,settings.slideshow)):e.prettyPhoto.changePage("next")},e.prettyPhoto.stopSlideshow=function(){$pp_pic_holder.find(".pp_pause").unbind("click").removeClass("pp_pause").addClass("pp_play").click(function(){return e.prettyPhoto.startSlideshow(),!1}),clearInterval(x),x=void 0},e.prettyPhoto.close=function(){s&&s.destroy&&s.destroy(),$pp_overlay.is(":animated")||(videoJsObj&&(videoJsObj.pause(),videoJsObj.player().trigger("pause")),e.prettyPhoto.stopSlideshow(),$pp_pic_holder.stop().find("object,embed,video").css("visibility","hidden"),e("div.pp_pic_holder,div.ppt,.pp_fade").fadeOut(settings.animation_speed,function(){e(this).remove()}),$pp_overlay.fadeOut(settings.animation_speed,function(){if(settings.hideflash&&e("object,embed,iframe[src*=youtube],iframe[src*=vimeo],iframe[src*=slideshare]").css("visibility","visible"),e(this).remove(),e(window).unbind("scroll.prettyphoto"),settings.callback(),doresize=!0,w=!1,videoJsObj){try{videoJsObj.dispose()}catch(i){}videoJsObj=null}delete settings}),window.isLearnbitModalOpen=!1)},!pp_alreadyInitialized&&i()&&(pp_alreadyInitialized=!0,hashIndex=i(),hashRel=hashIndex,hashIndex=hashIndex.substring(hashIndex.indexOf("/")+1,hashIndex.length-1),hashRel=hashRel.substring(0,hashRel.indexOf("/")),setTimeout(function(){e("a["+o.hook+"^='"+hashRel+"']:eq("+hashIndex+")").trigger("click")},50)),this.unbind("click.prettyphoto").bind("click.prettyphoto",e.prettyPhoto.initialize)}}(jQuery);var pp_alreadyInitialized=!1;
