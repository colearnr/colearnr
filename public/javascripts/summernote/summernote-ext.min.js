!function(e){var n=e.summernote.renderer.getTemplate(),t=e.summernote.eventHandler.getEditor(),r=e.summernote.core.range,o=e.summernote.core.dom,i=function(e,n,t){var o=n.url,i=n.embedLink,a=n.range,d=function(){var e=a.insertNode(l(n));r.createFromNode(e).select()};a=a.deleteContents(),i&&t.onCreateLink?t.onCreateLink(o,e,n,t):d()},a=function(n,t){var r,o="980",i="620";return"small"==t.toLowerCase()?(o="500",i="420"):"medium"==t.toLowerCase()&&(o="740",i="520"),r=e('<iframe webkitallowfullscreen mozallowfullscreen allowfullscreen class="flex-embed">').attr("src",n).attr("width",o).attr("height",i).attr("frameborder",0),r[0]},l=function(n){var t=n.url,r=n.text,o=n.newWindow,i=n.embedLink,a=e("<A>"+r+"</A>");return e(a).attr({href:t,target:o?"_blank":"","data-embed":i?"true":"false"}),a[0]},d=function(e,n){e.toggleClass("disabled",!n),e.attr("disabled",!n)},s=function(n){n.focus();var t=r.create().expand(o.isAnchor),i=e(t.nodes(o.isAnchor)[0]);return{range:t,text:t.toString(),isNewWindow:i.length?"_blank"===i.attr("target"):!0,url:i.length?i.attr("href"):"",isEmbed:i.length?"true"===i.attr("data-embed"):!0}},c=function(n,t,r){return e.Deferred(function(e){var n=t.find(".note-embed-dialog"),o=n.find(".note-embed-text"),i=n.find(".note-embed-url"),a=n.find(".note-embed-btn"),l=n.find("#openInNewWindow"),s=n.find("#embedLink");n.one("shown.bs.modal",function(){o.val(r.text),o.on("input",function(){r.text=o.val()}),r.url||(r.url=r.text,d(a,r.text)),i.on("input",function(){d(a,i.val()),r.text||o.val(i.val())}).val(r.url).trigger("focus").trigger("select"),l.prop("checked",r.newWindow),s.prop("checked",r.embedLink),a.one("click",function(t){t.preventDefault(),e.resolve({range:r.range,url:i.val(),text:o.val(),newWindow:l.is(":checked"),embedLink:s.is(":checked")}),n.modal("hide")})}).one("hidden.bs.modal",function(){o.off("input"),i.off("input"),a.off("click"),"pending"===e.state()&&e.reject()}).modal("show")}).promise()};e.summernote.addPlugin({name:"embed",buttons:{embed:function(){return n.iconButton("fa fa-link",{event:"showEmbedDialog",title:"Link",hide:!0})}},dialogs:{embed:function(e,t){var r='<div class="form-group row"><label>'+e.link.textToDisplay+'</label><input class="note-embed-text form-control span12" type="text" /></div><div class="form-group row"><label>'+e.link.url+'</label><input class="note-embed-url form-control span12" type="text" /></div>'+(t.disableLinkTarget?"":'<div class="checkbox"><label><input name="openInNewWindow" id="openInNewWindow" type="checkbox" checked> '+e.link.openInNewWindow+"</label></div>")+(t.disableLinkEmbed?"":'<div class="checkbox"><label><input name="embedLink" id="embedLink" type="checkbox" checked> Embed this link</label></div>'),o='<button href="#" class="btn btn-primary note-embed-btn disabled" disabled>'+e.link.insert+"</button>";return n.dialog("note-embed-dialog",e.link.insert,r,o)}},events:{showEmbedDialog:function(e){var n=e.editor(),r=e.dialog(),o=e.editable(),a=s(o),l=n.data("options");t.saveRange(o),c(o,r,a).then(function(e){t.restoreRange(o),i(o,e,l)}).fail(function(){t.restoreRange(o)})},createIFrameNode:function(e,n,r){var o=e.editable();t.restoreRange(o);var i=a(n,r);return t.insertNode(o,i),i},createSimpleLinkNode:function(e,n,r){var o=e.editable();t.restoreRange(o);var i=l(r);return t.insertNode(o,i),i}}})}(jQuery);!function(e){var a=e.summernote.renderer.getTemplate(),l=e.summernote.eventHandler.getEditor(),n={},o=function(e){var a,l;if(window.getSelection){if(a=window.getSelection(),a.getRangeAt&&a.rangeCount){l=a.getRangeAt(0),l.deleteContents();var n=document.createElement("div");n.innerHTML=e;for(var o,t,c=document.createDocumentFragment();o=n.firstChild;)t=c.appendChild(o);l.insertNode(c),t&&(l=l.cloneRange(),l.setStartAfter(t),l.collapse(!0),a.removeAllRanges(),a.addRange(l))}}else document.selection&&"Control"!=document.selection.type&&document.selection.createRange().pasteHTML(e)};e.summernote.addPlugin({name:"addTag",buttons:{addTag:function(){var e=[{clazz:"todo",icon:"square-o",label:"To Do",continuous:!0},{clazz:"done",icon:"check-square-o",label:"Done"},{clazz:"important",icon:"star",label:"Important"},{clazz:"task",icon:"tasks",label:"Task",continuous:!0},{clazz:"research",icon:"search",label:"Research"},{clazz:"book",icon:"book",label:"Learn"},{clazz:"heart",icon:"heart-o",label:"Like"},{clazz:"at",icon:"at",label:"Mention"},{clazz:"bell",icon:"bell",label:"Alert"},{clazz:"bookmark",icon:"bookmark",label:"Bookmark"},{clazz:"question",icon:"question",label:"Question",continuous:!0},{clazz:"bug",icon:"bug",label:"Bug",continuous:!0},{clazz:"calendar",icon:"calendar",label:"Event"},{clazz:"comment",icon:"comment-o",label:"Discuss"},{clazz:"dot-circle",icon:"dot-circle-o",label:"Dot"},{clazz:"envelope",icon:"envelope-o",label:"Mail"},{clazz:"exclamation",icon:"exclamation-triangle",label:"Warning"},{clazz:"eye",icon:"eye",label:"Watch"},{clazz:"university",icon:"university",label:"University"},{clazz:"lock",icon:"lock",label:"Secret"},{clazz:"quote",icon:"quote-left",label:"Quote"},{clazz:"lightbulb",icon:"lightbulb-o",label:"Idea"},{clazz:"brainstorm",icon:"sitemap",label:"Brainstorm"},{clazz:"share",icon:"share-alt",label:"Share"},{clazz:"trophy",icon:"trophy",label:"Trophy"},{clazz:"doubt",icon:"hand-o-up",label:"Doubt"},{clazz:"users",icon:"users",label:"Friends"}],l="";e.forEach(function(e){n[e.clazz]=e,l=l+'<li class="note_tag '+e.clazz+'"><a data-event="addTag" href="#" data-value="',l=l+e.clazz+'"><i class="fa fa-'+e.icon+'"></i> &nbsp;'+e.label+"</li>"});var o='<ul class="dropdown-menu columns">'+l+"</ul>";return a.iconButton("fa fa-tags",{title:"Insert Tags",hide:!0,dropdown:o})}},events:{addTag:function(e,a){var t=e.editable();l.saveRange(t);var c=n[a],i="";c.continuous?(i='<p><div class="note_tag '+c.clazz+'" title="'+c.label+'"><i class="fa fa-'+c.icon+'"></i> &nbsp;'+c.label+"</div></p>",o(i)):(i='<p><div class="note_tag '+c.clazz+'" title="'+c.label+'"><i class="fa fa-'+c.icon+'"></i> &nbsp;'+c.label+"</div></p>",o(i))}}})}(jQuery);!function(e){var o=e.summernote.renderer.getTemplate(),t=e.summernote.eventHandler.getEditor(),r=function(o,t){var r="680",n="520";"small"===t.toLowerCase()?(r="400",n="280"):"medium"===t.toLowerCase()?(r="520",n="400"):"full"===t.toLowerCase()&&(r="840",n="680");var i=e('<iframe webkitallowfullscreen mozallowfullscreen allowfullscreen class="flex-video">').attr("src",o).attr("width",r).attr("height",n).attr("frameborder",0);return i[0]},n=function(){var o={};return e.summernote.allOptions&&e.summernote.allOptions.plugins&&e.summernote.allOptions.plugins.video&&(o=e.summernote.allOptions.plugins.video),e.Deferred(function(e){var t=o.uploadServerPrefix,r=o.storagePath,n=o.urlPrefix,i=o.embedSize;void 0===typeof window.filepicker?e.reject():window.filepicker.pickAndStore({extensions:["mov","mp4","m4v","webm","flv"],container:"modal",services:["COMPUTER","VIDEO"],openTo:"VIDEO",multiple:"false"},{location:"S3",path:r,access:"public"},function(o){if(o&&o[0]){var r=n+"&url="+encodeURIComponent(t+o[0].key)+"&embedSize="+i;e.resolve(r,i)}else e.reject()})})};e.summernote.addPlugin({name:"video",buttons:{video:function(){return o.iconButton("fa fa-youtube-play",{event:"showVideoDialog",title:"Video",hide:!0})}},events:{showVideoDialog:function(e){var o=e.editable();t.saveRange(o),n(o).then(function(e,n){t.restoreRange(o),t.insertNode(o,r(e,n))}).fail(function(){t.restoreRange(o)})},createVideoNode:function(e,o,n){var i=e.editable();t.restoreRange(i);var a=r(o,n);return t.insertNode(i,a),a}}})}(jQuery);